From 7d18dbed87da56bd6ce632611cd6983084c01c80 Mon Sep 17 00:00:00 2001
From: Claude <noreply@anthropic.com>
Date: Mon, 1 Dec 2025 14:15:19 +0000
Subject: [PATCH] feat: Configure packages for npm publishing under
 @groveengine org
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

- Rename @grove/engine to @groveengine/engine
- Rename @groveplace/ui to @groveengine/ui
- Add exports configuration for components, utils, auth
- Add @sveltejs/package for library builds
- Add peerDependencies (svelte, sveltekit, tailwindcss)
- Create main index.ts entry point exporting all modules

This enables AutumnsGrove to import from @groveengine/engine:
- import { ContentWithGutter } from '@groveengine/engine'
- import { parseMarkdown } from '@groveengine/engine/utils/markdown'
- import { verifySession } from '@groveengine/engine/auth/session'

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
---
 packages/engine/package.json     | 61 +++++++++++++++++++++++++++++++-
 packages/engine/src/lib/index.ts | 56 +++++++++++++++++++++++++++++
 packages/ui/package.json         |  2 +-
 3 files changed, 117 insertions(+), 2 deletions(-)
 create mode 100644 packages/engine/src/lib/index.ts

diff --git a/packages/engine/package.json b/packages/engine/package.json
index 61ba130..eba6faa 100644
--- a/packages/engine/package.json
+++ b/packages/engine/package.json
@@ -1,5 +1,5 @@
 {
-  "name": "@grove/engine",
+  "name": "@groveengine/engine",
   "version": "0.1.0",
   "description": "Multi-tenant blog engine for Grove Platform. Features gutter annotations, markdown editing, magic code auth, and Cloudflare Workers deployment.",
   "author": "AutumnsGrove",
@@ -17,10 +17,63 @@
     "multi-tenant"
   ],
   "type": "module",
+  "svelte": "./dist/index.js",
+  "types": "./dist/index.d.ts",
+  "exports": {
+    ".": {
+      "types": "./dist/index.d.ts",
+      "svelte": "./dist/index.js",
+      "default": "./dist/index.js"
+    },
+    "./components/custom/*": {
+      "types": "./dist/components/custom/*.svelte.d.ts",
+      "svelte": "./dist/components/custom/*.svelte",
+      "default": "./dist/components/custom/*.svelte"
+    },
+    "./components/admin/*": {
+      "types": "./dist/components/admin/*.svelte.d.ts",
+      "svelte": "./dist/components/admin/*.svelte",
+      "default": "./dist/components/admin/*.svelte"
+    },
+    "./components/gallery/*": {
+      "types": "./dist/components/gallery/*.svelte.d.ts",
+      "svelte": "./dist/components/gallery/*.svelte",
+      "default": "./dist/components/gallery/*.svelte"
+    },
+    "./components/ui": {
+      "types": "./dist/components/ui/index.d.ts",
+      "svelte": "./dist/components/ui/index.js",
+      "default": "./dist/components/ui/index.js"
+    },
+    "./components/ui/*": {
+      "types": "./dist/components/ui/*.svelte.d.ts",
+      "svelte": "./dist/components/ui/*.svelte",
+      "default": "./dist/components/ui/*.svelte"
+    },
+    "./utils/*": {
+      "types": "./dist/utils/*.d.ts",
+      "default": "./dist/utils/*.js"
+    },
+    "./auth/*": {
+      "types": "./dist/auth/*.d.ts",
+      "default": "./dist/auth/*.js"
+    },
+    "./server/*": {
+      "types": "./dist/server/*.d.ts",
+      "default": "./dist/server/*.js"
+    }
+  },
+  "files": [
+    "dist",
+    "!dist/**/*.test.*"
+  ],
   "scripts": {
     "dev": "vite dev",
     "dev:wrangler": "wrangler pages dev -- vite dev",
     "build": "vite build",
+    "build:package": "svelte-kit sync && svelte-package -o dist",
+    "package": "npm run build:package",
+    "prepublishOnly": "npm run build:package",
     "preview": "vite preview",
     "audit": "npm audit --audit-level=moderate",
     "audit:fix": "npm audit fix",
@@ -35,6 +88,7 @@
     "@lucide/svelte": "^0.482.0",
     "@sveltejs/adapter-cloudflare": "^7.2.4",
     "@sveltejs/kit": "^2.5.28",
+    "@sveltejs/package": "^2.3.0",
     "@sveltejs/vite-plugin-svelte": "^4.0.0",
     "@tailwindcss/typography": "^0.5.19",
     "@testing-library/jest-dom": "^6.9.1",
@@ -63,5 +117,10 @@
     "mermaid": "^11.12.1",
     "sonner": "^2.0.7",
     "tailwind-merge": "^3.4.0"
+  },
+  "peerDependencies": {
+    "svelte": "^5.0.0",
+    "@sveltejs/kit": "^2.0.0",
+    "tailwindcss": "^3.4.0"
   }
 }
diff --git a/packages/engine/src/lib/index.ts b/packages/engine/src/lib/index.ts
new file mode 100644
index 0000000..a8e4d37
--- /dev/null
+++ b/packages/engine/src/lib/index.ts
@@ -0,0 +1,56 @@
+// @groveengine/engine - Main entry point
+// Multi-tenant blog engine for Grove Platform
+
+// ============================================
+// Custom Blog Components
+// ============================================
+export { default as ContentWithGutter } from './components/custom/ContentWithGutter.svelte';
+export { default as GutterItem } from './components/custom/GutterItem.svelte';
+export { default as LeftGutter } from './components/custom/LeftGutter.svelte';
+export { default as TableOfContents } from './components/custom/TableOfContents.svelte';
+export { default as MobileTOC } from './components/custom/MobileTOC.svelte';
+export { default as CollapsibleSection } from './components/custom/CollapsibleSection.svelte';
+
+// ============================================
+// Admin Components
+// ============================================
+export { default as MarkdownEditor } from './components/admin/MarkdownEditor.svelte';
+export { default as GutterManager } from './components/admin/GutterManager.svelte';
+
+// ============================================
+// Gallery Components
+// ============================================
+export { default as ImageGallery } from './components/gallery/ImageGallery.svelte';
+export { default as Lightbox } from './components/gallery/Lightbox.svelte';
+export { default as LightboxCaption } from './components/gallery/LightboxCaption.svelte';
+export { default as ZoomableImage } from './components/gallery/ZoomableImage.svelte';
+
+// ============================================
+// UI Components (re-export from ui/index)
+// ============================================
+export * from './components/ui/index';
+
+// ============================================
+// Utilities
+// ============================================
+export * from './utils/markdown.js';
+export * from './utils/sanitize.js';
+export * from './utils/csrf.js';
+export * from './utils/gutter.js';
+export * from './utils/gallery.js';
+export * from './utils/validation.js';
+export * from './utils/api.js';
+export * from './utils/debounce.js';
+export * from './utils/json.js';
+export { cn } from './utils/cn';
+
+// ============================================
+// Auth
+// ============================================
+export * from './auth/jwt.js';
+export * from './auth/session.js';
+
+// ============================================
+// Server utilities (for use in +server.js files)
+// ============================================
+export * from './server/logger.js';
diff --git a/packages/ui/package.json b/packages/ui/package.json
index 46ebdce..d995f37 100644
--- a/packages/ui/package.json
+++ b/packages/ui/package.json
@@ -1,5 +1,5 @@
 {
-  "name": "@groveplace/ui",
+  "name": "@groveengine/ui",
   "version": "0.1.0",
   "description": "Grove Design System - A calm, organic component library for the Grove blogging platform",
   "type": "module",
-- 
2.43.0

